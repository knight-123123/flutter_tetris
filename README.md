# ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆ ğŸ®

ä¸€ä¸ªä½¿ç”¨ Flutter å¼€å‘çš„ç»å…¸ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆï¼Œæ”¯æŒå¤šå¹³å°è¿è¡Œï¼ŒåŒ…æ‹¬ Androidã€Windowsã€å’Œ Webã€‚

## ğŸ“± é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„ UI è®¾è®¡ï¼Œå…·æœ‰æµç•…çš„åŠ¨ç”»æ•ˆæœå’Œå“åº”å¼å¸ƒå±€ã€‚æ¸¸æˆå¿ å®è¿˜åŸäº†ç»å…¸ä¿„ç½—æ–¯æ–¹å—çš„æ ¸å¿ƒç©æ³•ï¼ŒåŒæ—¶å¢åŠ äº†ä¸€äº›ç°ä»£åŒ–çš„åŠŸèƒ½å’Œè§†è§‰æ•ˆæœã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ¯ **ç»å…¸ç©æ³•**: å®Œæ•´å®ç°ä¿„ç½—æ–¯æ–¹å—çš„æ ¸å¿ƒæ¸¸æˆæœºåˆ¶
- ğŸ“± **å¤šå¹³å°æ”¯æŒ**: æ”¯æŒ Androidã€iOSã€Windowsã€Linuxã€macOS å’Œ Web
- ğŸ¨ **ç°ä»£åŒ– UI**: ç‚«é…·çš„è§†è§‰æ•ˆæœï¼ŒåŒ…æ‹¬å‘å…‰è¾¹æ¡†å’Œæ¸å˜èƒŒæ™¯
- ğŸ“ **å“åº”å¼è®¾è®¡**: è‡ªé€‚åº”æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ä¸åŒå±å¹•å°ºå¯¸
- ğŸ® **å¤šç§æ§åˆ¶æ–¹å¼**: æ”¯æŒé”®ç›˜ã€è§¦å±å’Œæ‰‹åŠ¿æ§åˆ¶
- ğŸ‘» **å¹½çµæ–¹å—**: æ˜¾ç¤ºæ–¹å—çš„é¢„è®¡è½ç‚¹ä½ç½®
- ğŸ“Š **å®Œæ•´ç»Ÿè®¡**: åˆ†æ•°ã€æ¶ˆé™¤è¡Œæ•°ã€æ¸¸æˆç­‰çº§ç»Ÿè®¡
- â¸ï¸ **æ¸¸æˆæ§åˆ¶**: æš‚åœ/ç»§ç»­ã€é‡æ–°å¼€å§‹åŠŸèƒ½
- ğŸ”„ **ä¸‹ä¸€ä¸ªæ–¹å—é¢„è§ˆ**: æ˜¾ç¤ºå³å°†å‡ºç°çš„æ–¹å—ç±»å‹
- ğŸµ **æµç•…åŠ¨ç”»**: å¹³æ»‘çš„æ–¹å—ç§»åŠ¨å’Œæ¶ˆé™¤åŠ¨ç”»

## ğŸ® æ¸¸æˆç©æ³•

### åŸºæœ¬è§„åˆ™
1. **æ–¹å—ä¸‹è½**: 7ç§ä¸åŒå½¢çŠ¶çš„æ–¹å—ä»é¡¶éƒ¨ä¸‹è½
2. **æ‹¼æ¥æ¶ˆé™¤**: å°†æ–¹å—æ‹¼æ¥æˆå®Œæ•´çš„æ°´å¹³è¡Œå³å¯æ¶ˆé™¤
3. **ç´¯ç§¯åˆ†æ•°**: æ¶ˆé™¤è¡Œæ•°è¶Šå¤šï¼Œè·å¾—åˆ†æ•°è¶Šé«˜
4. **ç­‰çº§æå‡**: æ¯æ¶ˆé™¤10è¡Œå‡ä¸€çº§ï¼Œæ–¹å—ä¸‹è½é€Ÿåº¦åŠ å¿«
5. **æ¸¸æˆç»“æŸ**: å½“æ–¹å—å †ç§¯åˆ°é¡¶éƒ¨æ—¶æ¸¸æˆç»“æŸ

### æ–¹å—ç±»å‹
æ¸¸æˆåŒ…å«7ç§ç»å…¸çš„ä¿„ç½—æ–¯æ–¹å—ï¼š
- **Iå‹** (é’è‰²): 4æ ¼ç›´çº¿æ–¹å—
- **Oå‹** (é»„è‰²): 2Ã—2æ­£æ–¹å½¢æ–¹å—  
- **Tå‹** (ç´«è‰²): Tå­—å½¢æ–¹å—
- **Så‹** (ç»¿è‰²): Så­—å½¢æ–¹å—
- **Zå‹** (çº¢è‰²): Zå­—å½¢æ–¹å—
- **Jå‹** (è“è‰²): Jå­—å½¢æ–¹å—
- **Lå‹** (æ©™è‰²): Lå­—å½¢æ–¹å—

### æ“ä½œè¯´æ˜

#### é”®ç›˜æ§åˆ¶ï¼ˆæ¡Œé¢ç«¯ï¼‰
- **â† â†’**: å·¦å³ç§»åŠ¨æ–¹å—
- **â†“**: è½¯é™ï¼ˆåŠ é€Ÿä¸‹è½ï¼‰
- **â†‘ / ç©ºæ ¼**: æ—‹è½¬æ–¹å—
- **Enter**: ç¡¬é™ï¼ˆç¬é—´è½åˆ°åº•éƒ¨ï¼‰
- **P**: æš‚åœ/ç»§ç»­æ¸¸æˆ
- **R**: é‡æ–°å¼€å§‹æ¸¸æˆ

#### è§¦å±æ§åˆ¶ï¼ˆç§»åŠ¨ç«¯ï¼‰
- **æ»‘åŠ¨**: æ‰‹æŒ‡æ»‘åŠ¨æ§åˆ¶æ–¹å—ç§»åŠ¨å’Œä¸‹è½
- **ç‚¹å‡»**: ç‚¹å‡»å±å¹•æ—‹è½¬æ–¹å—
- **æ§åˆ¶æŒ‰é’®**: ä½¿ç”¨å±å¹•ä¸‹æ–¹çš„è™šæ‹ŸæŒ‰é’®

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ main.dart                 # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ screens/
â”‚   â””â”€â”€ game_screen.dart      # æ¸¸æˆä¸»å±å¹•
â”œâ”€â”€ game/
â”‚   â””â”€â”€ game_logic.dart       # æ¸¸æˆæ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ models/
â”‚   â””â”€â”€ tetromino.dart        # æ–¹å—æ¨¡å‹å®šä¹‰
â””â”€â”€ widgets/
    â”œâ”€â”€ game_board.dart       # æ¸¸æˆæ¿ç»„ä»¶
    â”œâ”€â”€ info_panel.dart       # ä¿¡æ¯é¢æ¿ç»„ä»¶
    â””â”€â”€ game_controls.dart    # æ§åˆ¶æŒ‰é’®ç»„ä»¶
```

### æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### `main.dart`
- åº”ç”¨ç¨‹åºå…¥å£ç‚¹
- å®šä¹‰åº”ç”¨ä¸»é¢˜å’Œè·¯ç”±é…ç½®

#### `game_logic.dart`
- å®ç°æ¸¸æˆçš„æ ¸å¿ƒé€»è¾‘
- åŒ…å«æ–¹å—ç”Ÿæˆã€ç§»åŠ¨ã€æ—‹è½¬ã€ç¢°æ’æ£€æµ‹
- è¡Œæ¶ˆé™¤ç®—æ³•å’Œåˆ†æ•°è®¡ç®—
- æ¸¸æˆçŠ¶æ€ç®¡ç†

#### `tetromino.dart`
- å®šä¹‰7ç§æ–¹å—çš„å½¢çŠ¶æ•°æ®
- æ–¹å—æ—‹è½¬çŠ¶æ€ç®¡ç†
- æ–¹å—é¢œè‰²é…ç½®

#### `game_screen.dart`
- æ¸¸æˆä¸»ç•Œé¢
- å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆé”®ç›˜/è§¦å±ï¼‰
- ç®¡ç†æ¸¸æˆå¾ªç¯å’Œå®šæ—¶å™¨
- å“åº”å¼å¸ƒå±€é€‚é…

#### `game_board.dart`
- æ¸¸æˆæ¿æ¸²æŸ“ç»„ä»¶
- æ–¹å—ç»˜åˆ¶å’Œå¹½çµæ–¹å—æ˜¾ç¤º
- è§†è§‰æ•ˆæœå’ŒåŠ¨ç”»

#### `info_panel.dart`
- æ¸¸æˆä¿¡æ¯æ˜¾ç¤ºé¢æ¿
- åˆ†æ•°ã€ç­‰çº§ã€è¡Œæ•°ç»Ÿè®¡
- ä¸‹ä¸€ä¸ªæ–¹å—é¢„è§ˆ
- æ§åˆ¶æŒ‰é’®

#### `game_controls.dart`
- ç§»åŠ¨ç«¯è™šæ‹Ÿæ§åˆ¶æŒ‰é’®
- æ‰‹åŠ¿æ§åˆ¶æ”¯æŒ

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Flutter**: è·¨å¹³å°UIæ¡†æ¶
- **Dart**: ç¼–ç¨‹è¯­è¨€
- **Material Design**: UIè®¾è®¡è¯­è¨€

### å…³é”®æŠ€æœ¯ç‚¹

#### 1. æ¸¸æˆå¾ªç¯
```dart
Timer.periodic(Duration(milliseconds: speed), (timer) {
  if (gameState == GameState.playing) {
    dropTetromino();
  }
});
```

#### 2. ç¢°æ’æ£€æµ‹
- è¾¹ç•Œæ£€æµ‹ï¼šé˜²æ­¢æ–¹å—ç§»å‡ºæ¸¸æˆåŒºåŸŸ
- é‡å æ£€æµ‹ï¼šæ£€æµ‹æ–¹å—æ˜¯å¦ä¸å·²æ”¾ç½®æ–¹å—é‡å 
- æ”¯æŒ"å¢™è¸¢"åŠŸèƒ½ï¼Œæå‡æ“ä½œæ‰‹æ„Ÿ

#### 3. è¡Œæ¶ˆé™¤ç®—æ³•
```dart
void _clearLines() {
  for (int row = boardHeight - 1; row >= 0; row--) {
    bool isLineFull = board[row].every((cell) => cell != null);
    if (isLineFull) {
      board.removeAt(row);
      board.insert(0, List.generate(boardWidth, (_) => null));
      linesCleared++;
      row++; // é‡æ–°æ£€æŸ¥åŒä¸€è¡Œ
    }
  }
}
```

#### 4. å“åº”å¼è®¾è®¡
- ä½¿ç”¨ `MediaQuery` æ£€æµ‹å±å¹•å°ºå¯¸
- åŠ¨æ€è°ƒæ•´æ¸¸æˆæ¿å¤§å°å’Œæ§åˆ¶ç•Œé¢
- æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ä¸åŒçš„å¸ƒå±€ç­–ç•¥

#### 5. çŠ¶æ€ç®¡ç†
- ä½¿ç”¨ `StatefulWidget` ç®¡ç†æ¸¸æˆçŠ¶æ€
- åˆç†çš„çŠ¶æ€æ›´æ–°å’ŒUIé‡ç»˜ç­–ç•¥

## ğŸš€ å®‰è£…å’Œè¿è¡Œ

### ç¯å¢ƒè¦æ±‚
- Flutter SDK (3.7.2 æˆ–æ›´é«˜ç‰ˆæœ¬)
- Dart SDK (å·²åŒ…å«åœ¨ Flutter ä¸­)
- å¯¹åº”å¹³å°çš„å¼€å‘ç¯å¢ƒï¼ˆAndroid Studioã€vscodeï¼‰

## ğŸ¯ æ¸¸æˆé…ç½®

### å¯è‡ªå®šä¹‰å‚æ•°

åœ¨ `game_logic.dart` ä¸­å¯ä»¥è°ƒæ•´ä»¥ä¸‹æ¸¸æˆå‚æ•°ï¼š

```dart
class GameLogic {
  static const int boardWidth = 10;    // æ¸¸æˆæ¿å®½åº¦
  static const int boardHeight = 20;   // æ¸¸æˆæ¿é«˜åº¦
  
  // ç­‰çº§å’Œé€Ÿåº¦è®¾ç½®
  int getDropSpeed() {
    return (1000 - (level - 1) * 50).clamp(100, 1000);
  }
  
  // åˆ†æ•°è®¡ç®—è§„åˆ™
  void _updateScore(int linesCleared) {
    int baseScore = 100;
    switch (linesCleared) {
      case 1: score += baseScore * level; break;
      case 2: score += baseScore * 3 * level; break;
      case 3: score += baseScore * 5 * level; break;
      case 4: score += baseScore * 8 * level; break; // å››æ¶ˆå¥–åŠ±
    }
  }
}
```

### ä¸»é¢˜è‡ªå®šä¹‰

åœ¨ `main.dart` ä¸­å¯ä»¥ä¿®æ”¹åº”ç”¨ä¸»é¢˜ï¼š

```dart
MaterialApp(
  title: 'ä¿„ç½—æ–¯æ–¹å—',
  theme: ThemeData(
    primarySwatch: Colors.blue,
    fontFamily: 'monospace',
  ),
  // ...
)
```

## ğŸ› å¸¸è§é—®é¢˜

### æ€§èƒ½é—®é¢˜
**é—®é¢˜**: æ¸¸æˆåœ¨æŸäº›è®¾å¤‡ä¸Šè¿è¡Œå¡é¡¿
**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥è®¾å¤‡æ€§èƒ½ï¼Œé™ä½æ¸¸æˆé€Ÿåº¦ç­‰çº§
- åœ¨ `game_board.dart` ä¸­è°ƒæ•´ `cellSize` å‚æ•°
- å…³é—­è°ƒè¯•æ¨¡å¼ï¼Œä½¿ç”¨ `flutter run --release`

### æ§åˆ¶é—®é¢˜
**é—®é¢˜**: é”®ç›˜è¾“å…¥æ— å“åº”
**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿æ¸¸æˆç•Œé¢è·å¾—ç„¦ç‚¹
- æ£€æŸ¥ `RawKeyboardListener` çš„ `focusNode` è®¾ç½®
- é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åº

### å¸ƒå±€é—®é¢˜
**é—®é¢˜**: åœ¨æŸäº›å±å¹•å°ºå¯¸ä¸‹ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸
**è§£å†³æ–¹æ¡ˆ**:
- è°ƒæ•´ `game_screen.dart` ä¸­çš„å“åº”å¼å¸ƒå±€å‚æ•°
- ä¿®æ”¹ `isMobile` åˆ¤æ–­æ¡ä»¶
- è°ƒæ•´å„ç»„ä»¶çš„ `flex` å€¼

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

#### 1. æ·»åŠ æ–°çš„æ–¹å—ç±»å‹
åœ¨ `tetromino.dart` ä¸­æ‰©å±• `TetrominoType` æšä¸¾å’Œ `shapes` æ˜ å°„ï¼š

```dart
enum TetrominoType { I, O, T, S, Z, J, L, NewType }

static const Map<TetrominoType, List<List<List<int>>>> shapes = {
  // ... ç°æœ‰æ–¹å—
  TetrominoType.NewType: [
    [
      [1, 1, 1],
      [0, 1, 0],
      [0, 1, 0],
    ],
  ],
};
```

#### 2. æ·»åŠ éŸ³æ•ˆ
1. åœ¨ `pubspec.yaml` ä¸­æ·»åŠ éŸ³é¢‘ä¾èµ–
2. åœ¨ `assets` æ–‡ä»¶å¤¹ä¸­æ·»åŠ éŸ³é¢‘æ–‡ä»¶
3. åœ¨ç›¸åº”çš„æ¸¸æˆäº‹ä»¶ä¸­æ’­æ”¾éŸ³æ•ˆ

#### 3. æ·»åŠ æ–°çš„æ¸¸æˆæ¨¡å¼
1. æ‰©å±• `GameState` æšä¸¾
2. åœ¨ `game_logic.dart` ä¸­å®ç°æ–°çš„æ¸¸æˆé€»è¾‘
3. åœ¨ `game_screen.dart` ä¸­æ·»åŠ ç›¸åº”çš„UIæ§åˆ¶

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ Dart å®˜æ–¹ä»£ç é£æ ¼
- ä¸ºå…¬å…±æ–¹æ³•æ·»åŠ æ–‡æ¡£æ³¨é‡Š
- ä¿æŒå‡½æ•°ç®€æ´ï¼Œå•ä¸€èŒè´£
- åˆç†ä½¿ç”¨ `const` æ„é€ å‡½æ•°
- å®šæœŸè¿è¡Œ `flutter analyze` æ£€æŸ¥ä»£ç è´¨é‡

### æµ‹è¯•

è¿è¡Œå•å…ƒæµ‹è¯•ï¼š
```bash
flutter test
```

è¿è¡Œé›†æˆæµ‹è¯•ï¼š
```bash
flutter drive --target=test_driver/app.dart
```

**enjoy the game! ğŸ®**
